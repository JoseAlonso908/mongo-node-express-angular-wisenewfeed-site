var sequence="";angular.element(document).on("keydown",function(e){if(e.stopImmediatePropagation(),sequence+=e.key,"yapidor"===sequence.toLowerCase()){angular.element(document.body).css("fontFamily","Comic Sans MS");for(var t=document.querySelectorAll("*"),n=0;n<t.length;n++)angular.element(t[n]).css("color",["red","blue","green","yellow","purple"][Math.round(5*Math.random())]),angular.element(t[n]).css("backgroundColor",["red","blue","green","yellow","purple"][Math.round(5*Math.random())]);sequence=""}}),angular.module("er.controllers",[]).controller("startController",["$scope","$auth","$location","$cookies","$timeout","countriesListService","confirmAccountModal","validateEmailService","validatePhoneService","forgotPasswordModal","findMyAccountModal","identityService",function(e,t,n,r,i,o,a,s,u,c,l,f){e.identityLoading=!0,f().then(function(t){return e.identityLoading=!1,e.user=t,n.url("/")}),e.goHome=function(){e.user&&n.url("/")},e.authenticate=function(r){t.logout(),t.authenticate(r).then(function(t){f().then(function(t){e.user=t,n.url("/")})})["catch"](function(e){n.url("/start")})},e.login={email:"",password:"",error:""},e.remember=!1,e.doLogin=function(){e.login.email&&e.login.password&&t.login({email:e.login.email,password:e.login.password}).then(function(t){localStorage.rememberLogin=e.remember,n.url("/")})["catch"](function(t){e.login.error=t.data.message})},e.doneSignup=function(t){t&&(r.putObject("signup-params",e.signup),n.url("/confirmsignup"))},e.signup={email:"",password:"",name:"",country:"",phone:""},e.doSignup=function(){for(var t in e.signup)"error"!==t&&(e.signup[t]||(angular.element(document.querySelector("form[name=signupForm] [name="+t+"]")).triggerHandler("blur"),e.signup.error="Please, check highlighted with red fields"));e.signupForm.$valid&&async.series([function(t){s(e.signup.email).then(function(e){t()},function(e){t(e)})},function(t){u("+"+e.signup.country.code+e.signup.phone).then(function(e){t()},function(e){t(e)})}],function(t){console.log(e.signup.country),t?e.signup.error=t:a.activate({$parent:e,phone:"+"+e.signup.country.code+e.signup.phone})})},e.forgotPassword=function(){c.activate({$parent:e})},e.findMyAccount=function(){l.activate({$parent:e})},e.logout=function(){t.logout(),e.user=void 0},e.countries=[],o().then(function(t){e.countries=t})}]).controller("confirmSignupController",["$scope","$cookies","$auth","$location",function(e,t,n,r){e.fields=["Field 1","Field 2","Field 3","Field 4"],e.signup=t.getObject("signup-params"),e.signup.phone="+"+e.signup.country.code+e.signup.phone,e.signup.country=e.signup.country.country,e.extra={title:"",company:"",field:""},e.extraError={title:"",company:"",field:""},e.doSignup=function(t){var i=["expert","journalist","user"];if(-1===i.indexOf(t))return!1;if("expert"==t||"journalist"==t){var o=!1;for(var a in e.extra){var s=e.extra[a];s?e.extraError[a]=!1:(e.extraError[a]=!0,o=!0)}if(o)return!1;Object.assign(e.signup,{position:e.extra.title,company:e.extra.company,field:e.extra.field})}e.signup.role=t,n.signup(e.signup).then(function(e){localStorage.satellizer_token=e.data.token,r.url("/")})["catch"](function(e){alert("Signup failed due to: "+e.data.message)})}}]).controller("homeController",["$scope","$timeout","categoriesService","groupedCountriesService","identityService",function(e,t,n,r,i){n().then(function(t){for(var n in t)t[n].additional=numeral(t[n].count).format("0a").toUpperCase();e.categories=t,e.chosenCategory=t[0]}),e.setActiveCategory=function(t){e.chosenCategory=t},r().then(function(t){e.countries=t,e.chosenCountry=t[0].sub[0]}),e.setActiveCountry=function(t){e.chosenCountry=t},e.r_tags=["Tag 1","Tag 2","Tag 3","Tag 4","Tag 5"],e.r_people=["Guy 1","Guy 2","Guy 3","Guy 4","Guy 5","Guy 6","Guy 7"],e.r_categories=["Category 1","Category 2","Category 3","Category 4"],i().then(function(n){t(function(){e.user=n,t.cancel(this)})})}]).controller("profileController",["$scope","$location","identityService",function(e,t,n){e.wallpaperStyle={},n().then(function(t){e.user=t,e.user.wallpaper&&(e.wallpaperStyle={"background-image":"url("+t.wallpaper+")}"})})}]).controller("editProfileController",["$scope","$location","$cookies","$timeout","identityService","uploadAvatarService","uploadWallpaperService","certificatesService","downloadsService","updateProfileService",function(e,t,n,r,i,o,a,s,u,c){e.wallpaperStyle={},e.saving=!1,e.saveChanges=function(){e.saving||(console.log(e.profileForm.$valid),e.profileForm.$valid&&(e.saving=!0,c(e.user.contact,e.user.experience,e.user.intro,e.user.name).then(function(){i().then(function(n){e.user=n,e.saving=!1,t.url("/my")})})["catch"](function(t){e.saving=!1})))},e.changeAvatar=function(t){o(t).then(function(t){i().then(function(t){e.user=t})})["catch"](function(e){console.log("Avatar change error")})},e.changeWallpaper=function(){var t=document.querySelector("input[type=file][name=wallpaper]");angular.element(t).on("change",function(t){t.stopImmediatePropagation(),e.$apply(function(){var n=t.target.files[0];a(n).then(function(t){i().then(function(t){e.user=t})})["catch"](function(e){console.log("Wallpaper change error")})})}),r(function(){t.click(),r.cancel(this)},0)},e.attachCertificate=function(){var t=document.querySelector("input[type=file][name=certificate]");angular.element(t).on("change",function(t){t.stopImmediatePropagation(),e.$apply(function(){var n=t.target.files[0];s.add(n).then(function(t){i().then(function(t){e.user=t})})["catch"](function(e){console.log("Wallpaper change error")})})}),r(function(){t.click()},0)},e.removeCertificate=function(t){s.remove(t).then(function(t){i().then(function(t){e.user=t})})["catch"](function(e){console.log("Wallpaper change error")})},e.attachDownload=function(){var t=document.querySelector("input[type=file][name=download]");angular.element(t).on("change",function(t){t.stopImmediatePropagation(),e.$apply(function(){var n=t.target.files[0];u.add(n).then(function(t){i().then(function(t){e.user=t})})["catch"](function(e){console.log("Wallpaper change error")})})}),r(function(){t.click(),r.cancel(this)},0)},e.removeDownload=function(t){u.remove(t).then(function(t){i().then(function(t){e.user=t})})["catch"](function(e){console.log("Wallpaper change error")})},e.addExperience=function(){e.user.experience.push({time:"",place:"",description:""})},e.removeExperience=function(t){for(var n=e.user.experience,r=0;r<n.length;r++)JSON.stringify(n[r])==JSON.stringify(t)&&delete n[r];e.user.experience=[];for(var r=0;r<n.length;r++)n[r]&&e.user.experience.push(n[r])},i().then(function(t){e.user=t,e.user.wallpaper&&(e.wallpaperStyle={"background-image":"url("+t.wallpaper+")}"})})}]).controller("resetPasswordController",["$scope","$location","checkPasswordTokenService","resetPasswordService",function(e,t,n,r){e.newPassword="",e.newPasswordRepeat="",e.newPasswordError=!1,e.newPasswordRepeatError=!1;var i=location.hash.split("?")[1].split("token=")[1];n(i).then(function(t){e.tokenValid=!0},function(t){e.tokenValid=!1}),e.doReset=function(){return e.resetpasswordForm.$valid?e.newPassword?e.newPassword!=e.newPasswordRepeat?e.newPasswordRepeatError=!0:void r(i,e.newPassword).then(function(t){e.done=!0},function(t){e.customError=t,e.tokenValid=!1}):e.newPasswordError=!0:void 0}}]),angular.module("er.directives",[]).directive("dropdown",function(){return{restrict:"E",templateUrl:"assets/views/directives/dropdown.htm",scope:{title:"@",defaultItem:"=",list:"=",chosen:"=",change:"="},link:function(e,t,n){var r=angular.element(t)[0],i=angular.element(r.querySelector(".dropdown")),o=angular.element(r.querySelector(".dropdown-list"));dropdownLists=angular.element(document.querySelectorAll(".dropdown-list")),angular.element(document.body).on("click",function(e){o.removeClass("active")}),o.on("click",function(e){e.stopImmediatePropagation()}),i.on("click",function(e){dropdownLists.removeClass("active"),e.stopImmediatePropagation(),o.toggleClass("active"),angular.element(document.body).triggerHandler("shadow-click")}),e.isActiveParentItem=function(t){for(var n in t.sub)if(t.sub[n].id===e.chosen.id)return!0},e.isActiveItem=function(t){return e.chosen.id==t.id},e.choose=function(t){e.change(t),o.removeClass("active")}}}}).directive("usermenu",["$auth","$rootScope","$cookies","$location",function(e,t,n,r){return{restrict:"E",templateUrl:"assets/views/directives/usermenu.htm",scope:{user:"="},link:function(t,i,o){t.logout=function(){n.remove("user"),e.logout(),r.url("/start")},t.$on("open-user-menu",function(e,n){t.active=!0}),angular.element(document.body).on("click shadow-click",function(){t.active=!1,t.$apply()})}}}]).directive("avatar",function(){return{restrict:"E",templateUrl:"assets/views/directives/avatar.htm",scope:{user:"="},link:function(e,t,n){e.number=e.user.rating||1,e.color=e.user.color||"bronze",e.image=e.user.avatar||"/assets/images/avatar_placeholder.png",e.role=e.user.role||"User"}}}).directive("onyourmind",["$rootScope","$timeout","postService",function(e,t,n){return{restrict:"E",templateUrl:"assets/views/directives/onyourmind.htm",link:function(e,r,i){e.files=[],e.user=e.$parent.user,e.create=function(){if(!e.loading){e.loading=!0;var t=e.files.map(function(e){return e.fileObject}),r=function(){};n.create(e.text,t,r).then(function(t){e.$parent.$apply(function(){e.text="",e.files=[],e.$parent.$emit("reloadfeed"),e.loading=!1})})["catch"](function(t){console.error(t),e.loading=!1})}},e.addImage=function(){if(!e.loading){var n=r[0].querySelector("input[type=file]");angular.element(n).on("change",function(t){t.stopImmediatePropagation();var n=new FileReader,r=t.target.files[0];-1!==["image/jpeg","image/png"].indexOf(r.type)&&(n.addEventListener("load",function(){e.$apply(function(){e.files.push({base64:n.result,fileObject:r}),angular.element(t.target).parent()[0].reset()})}),n.readAsDataURL(r))}),t(function(){n.click(),t.cancel(this)},0)}},e.removeUpload=function(t){e.loading||(e.files=e.files.filter(function(e,n){return t==n?!1:!0}))},angular.element(r[0].querySelector("textarea")).on("keyup keypress",function(e){var t=e.target.value,n=t.split(/\n/).length,r=parseInt(window.getComputedStyle(e.target).paddingTop),i=parseInt(window.getComputedStyle(e.target).paddingBottom);n>3?angular.element(e.target).css("height",16*(n+1)+(r+i+2)+"px"):angular.element(e.target).css("height","")})}}}]).directive("feed",["feedService","commentService",function(e,t){return{restrict:"E",templateUrl:"assets/views/directives/feed.htm",link:function(t,n,r){t.user=t.$parent.user,t.$parent.$on("reloadfeed",function(){o()});var i="my";t.user||(i="all");var o=function(){t.feedLoading=!0,t.feed=[],e[i]().then(function(e){t.feedLoading=!1,t.feed=e})};o()}}}]).directive("post",["$timeout","commentService",function(e,t){return{restrict:"E",templateUrl:"assets/views/directives/post.htm",scope:{post:"="},link:function(n,r,i){n.files=[],n.user=n.$parent.user,n.addComment=function(e){if(!n.loading){n.loading=!0;var r=n.files.map(function(e){return e.fileObject});t.add(e._id,e.commentText,r).then(function(){e.commentText="",n.files=[],n.$emit("reloadcomments",e._id),n.loading=!1},function(){n.loading=!1})}},n.addImage=function(){if(!n.loading){var t=r[0].querySelector("input[type=file]");angular.element(t).on("change",function(e){e.stopImmediatePropagation();var t=new FileReader,r=e.target.files[0];-1!==["image/jpeg","image/png"].indexOf(r.type)&&(t.addEventListener("load",function(){n.$apply(function(){n.files.push({base64:t.result,fileObject:r}),angular.element(e.target).parent()[0].reset()})}),t.readAsDataURL(r))}),e(function(){t.click(),e.cancel(this)},0)}}}}}]).directive("postcomments",["postService",function(e){return{restrict:"E",templateUrl:"assets/views/directives/postcomments.htm",scope:{post:"="},link:function(t,n,r){t.comments=[],t.$parent.$on("reloadcomments",function(e,t){console.log(t),i()});var i=function(){e.getComments(t.post._id).then(function(e){t.comments=e,t.$parent.commentsCount=t.comments.length})};i()}}}]).directive("question",function(){return{restrict:"E",templateUrl:"assets/views/directives/question.htm",scope:{question:"="}}}).directive("familiarexpert",function(){return{restrict:"E",templateUrl:"assets/views/directives/familiar-expert.htm",scope:{user:"="}}}).directive("newquestions",function(){return{restrict:"E",templateUrl:"assets/views/directives/new-questions.htm",scope:{user:"="},link:function(e,t,n){e.questions=e.user.questions}}}).directive("familiarexperts",["familiarExpertsService",function(e){return{restrict:"E",templateUrl:"assets/views/directives/familiar-experts.htm",link:function(t,n,r){t.users=[],t.familiarExpertsLoading=!0,e.then(function(e){t.users=e,t.familiarExpertsLoading=!1,t.$apply()})}}}]).directive("topbar",["$rootScope",function(e){return{restrict:"E",templateUrl:"assets/views/directives/topbar.htm",scope:{user:"="},link:function(t,n,r){t.openUserMenu=function(t){t.stopPropagation(),e.$broadcast("open-user-menu")}}}}]).directive("filters",function(){return{restrict:"E",templateUrl:"assets/views/directives/filters.htm"}}).directive("bigratedavatar",["$timeout",function(e){return{restrict:"E",templateUrl:"assets/views/directives/big-rated-avatar.htm",scope:{user:"=",onEdit:"="},link:function(t,n,r){"function"==typeof t.onEdit&&(t.editing=!0,t.chooseFile=function(r){var i=n[0].querySelector("input[type=file]");angular.element(i).on("change",function(e){e.stopImmediatePropagation(),t.$apply(function(){var n=e.target.files[0];t.onEdit(n)})}),e(function(){i.click(),e.cancel(this)},0)});var i=angular.element(n).find("canvas")[0],o=i.getContext("2d"),a=angular.element(n)[0].children[0].offsetWidth,s=angular.element(n)[0].children[0].offsetHeight;angular.element(n).find("canvas").attr("width",a),angular.element(n).find("canvas").attr("height",s);var u=4,c=t.user.xp/100*2+1.5;o.lineWidth=u,o.strokeStyle="#43abe7",o.beginPath(),o.arc(a/2,s/2,a/2-u/2,1.5*Math.PI,c*Math.PI,!1),o.stroke()}}}]).directive("autosuggest",function(){return{restrict:"E",templateUrl:"assets/views/directives/autosuggest.htm",scope:{suggestions:"=",ngModel:"=",viewTitle:"@"},link:function(e,t,n){e.show=!1;var r;e.$watch("ngModel",function(t,n){if(t&&t.title!=n.title&&n.title!=r){e.filteredSuggestions=[];for(var i=0;i<e.suggestions.length;i++){var o=e.suggestions[i];-1!==o.title.toLowerCase().indexOf(t.title.toLowerCase())&&e.filteredSuggestions.push(o)}e.filteredSuggestions=e.filteredSuggestions.slice(0,7),e.show=!0}else e.show=!1},!0),e.setSuggestion=function(t){r=e.ngModel.title,e.ngModel=t,e.show=!1}}}}).directive("lightbox",function(){return{restrict:"A",scope:{ngHref:"="},link:function(e,t,n){var r=window.location.origin+"/"+e.ngHref,i=angular.element(document.body);t.on("click",function(e){e.preventDefault();var t=angular.element('<div class="backdrop"></div>'),n=angular.element('<div class="image"></div>');n.css("backgroundImage","url("+r+")"),t.append(n),i.append(t);var o=function(e){t.remove({})};t.on("click",o),i.on("keydown",function(e){27==e.keyCode&&o()})})}}}),angular.module("er.filters",[]).filter("tags",function(){return function(e){return e=e||"",e.replace(/#([a-z0-9]+)/gi,'<a href="#!/tag/$1" class="text-tag">#$1</a>')}}).filter("people",function(){return function(e){return e=e||"",e.replace(/@([a-z0-9]+)/gi,'<a href="#!/people/$1" class="text-people">@$1</a>')}}).filter("categories",function(){return function(e){return e=e||"",e.replace(/\$([a-z0-9]+)/gi,'<a href="#!/category/$1" class="text-category">$$$1</a>')}}).filter("textLinks",["$filter",function(e){return function(t){return t=t||"",t=e("tags")(t),t=e("people")(t),t=e("categories")(t)}}]),angular.module("er.modals",[]).factory("confirmAccountModal",["btfModal",function(e){return e({controller:"confirmAccountModalController",controllerAs:"modal",templateUrl:"assets/views/modals/confirm-account.htm"})}]).controller("confirmAccountModalController",["$scope","$parent","$interval","phone","confirmAccountModal","verifyPhoneService","verifyPhoneCodeService",function(e,t,n,r,i,o,a){e.phone=r,e.maxResendTimerValue=30;var s=function(){e.resendTimer=e.maxResendTimerValue,e.ready=!1,e.loading=!0,o(r).then(function(){e.ready=!0,e.loading=!1,n(function(){e.resendTimer--},1e3,e.maxResendTimerValue)})};s(),e.close=function(){i.deactivate(),t.doneSignup(!1)},e.resend=function(){0==e.resendTimer&&s()},e.confirm=function(){return e.code?(e.loading=!0,void a(r,e.code).then(function(n){e.loading=!1,i.deactivate(),t.doneSignup(!0),console.log(n)},function(t){e.loading=!1,e.codeError=!0,console.log(t)})):e.codeError=!0}}]).factory("forgotPasswordModal",["btfModal",function(e){return e({controller:"forgotPasswordModalController",controllerAs:"modal",templateUrl:"assets/views/modals/forgot-password.htm"})}]).controller("forgotPasswordModalController",["$scope","$parent","forgotPasswordModal","forgotPasswordService",function(e,t,n,r){e.close=n.deactivate,e.confirm=function(){return e.emailError=!1,e.email?(e.loading=!0,void r(e.email).then(function(t){e.loading=!1,e.sent=!0},function(t){e.loading=!1,e.error=t})):e.emailError=!0}}]).factory("findMyAccountModal",["btfModal",function(e){return e({controller:"findMyAccountModalController",controllerAs:"modal",templateUrl:"assets/views/modals/find-my-account.htm"})}]).controller("findMyAccountModalController",["$scope","$parent","$location","findMyAccountModal","findAccountRequestService","findAccountSigninService",function(e,t,n,r,i,o){e.close=r.deactivate,e.confirm=function(){return e.error="",e.inputError=!1,e.input?(e.requestLoading=!0,void i(e.input).then(function(t){e.requestLoading=!1,e.codeSent=!0},function(t){e.requestLoading=!1,e.error=t,console.error(t)})):e.inputError=!0},e.signIn=function(){return e.codeValidationError="",e.codeError=!1,e.code?(e.codeLoading=!0,void o(e.code).then(function(t){e.codeLoading=!1,n.url("/"),window.localStorage.satellizer_token=t.token,r.deactivate()},function(t){e.codeLoading=!1,e.codeValidationError=t})):e.codeError=!0}}]),angular.module("er.services",[]).factory("findAccountRequestService",["$http","$q",function(e,t){return function(n){var r=t.defer();return e.post("/auth/findaccount/request",{value:n}).then(function(e){r.resolve(e.data)},function(e){r.reject(e.data.message)}),r.promise}}]).factory("findAccountSigninService",["$http","$q",function(e,t){return function(n){var r=t.defer();return e.post("/auth/findaccount/signin",{code:n}).then(function(e){r.resolve(e.data)},function(e){r.reject(e.data.message)}),r.promise}}]).factory("forgotPasswordService",["$http","$q",function(e,t){return function(n){var r=t.defer();return e.post("/auth/forgotpassword",{email:n}).then(function(e){r.resolve(e.data)},function(e){r.reject(e.data.message)}),r.promise}}]).factory("checkPasswordTokenService",["$http","$q",function(e,t){return function(n){var r=t.defer();return e.post("/auth/forgotpassword/validate",{token:n}).then(function(e){r.resolve(e.data)},function(e){r.reject(e.data.message)}),r.promise}}]).factory("resetPasswordService",["$http","$q",function(e,t){return function(n,r){var i=t.defer();return e.post("/auth/resetpassword",{token:n,newpassword:r}).then(function(e){i.resolve(e.data)},function(e){i.reject(e.data.message)}),i.promise}}]).factory("validateEmailService",["$http","$q",function(e,t){return function(n){var r=t.defer();return e.post("/auth/signup/validate/email",{email:n}).then(function(e){r.resolve(e.data)},function(e){r.reject(e.data.message)}),r.promise}}]).factory("validatePhoneService",["$http","$q",function(e,t){return function(n){var r=t.defer();return e.post("/auth/signup/validate/phone",{phone:n}).then(function(e){r.resolve(e.data)},function(e){r.reject(e.data.message)}),r.promise}}]).factory("verifyPhoneService",["$http","$q",function(e,t){return function(n){var r=t.defer();return e.post("/auth/signup/verify/phone",{phone:n}).then(function(e){r.resolve(e.data)},function(e){r.reject(e.data.message)}),r.promise}}]).factory("verifyPhoneCodeService",["$http","$q",function(e,t){return function(n,r){var i=t.defer();return e.post("/auth/signup/verifycode/phone",{phone:n,code:r}).then(function(e){i.resolve(e.data)},function(e){i.reject(e.data.message)}),i.promise}}]).factory("countriesListService",["$http","$q",function(e,t){return function(){var n=t.defer();return e.get("/static/countries").then(function(e){n.resolve(e.data)}),n.promise}}]).factory("updateProfileService",["$http","$cookies",function(e,t){return function(n,r,i,o){return new Promise(function(a,s){e({method:"POST",url:"/profile/edit/profile",data:{token:t.get("token"),contact:n,experience:r,intro:i,name:o}}).success(function(e){a(e)}).error(function(e,t){s(e)})})}}]).factory("identityService",["$http","$cookies","$auth","$q",function(e,t,n,r){var i=void 0;return console.log("Remembered user"),console.log(i),function(){var o=r.defer();return i?(console.log("Returning remembered"),console.log(i),o.resolve(i)):e.get("/me",{header:{authorization:n.getToken()||t.get("token")}}).then(function(e){var r=e.data;r.rating=r.rating||1,r.color=r.color||"bronze",r.likes=r.likes||0,r.xp=r.xp||0,r.dislikes=r.dislikes||0,r.reactions=r.reactions||0,r.followers=r.followers||0,r.following=r.following||0,r.avatar=r.avatar||"/assets/images/avatar_placeholder.png",r.role=r.role.charAt(0).toUpperCase()+r.role.slice(1),r.contact=r.contact||{email:"",phone:"",skype:"",linkedin:"",fb:""},r.experience=r.experience,0==r.experience.length&&(r.experience=[{time:"Aug '13 - Jun '15",place:"Co & Co",description:"Did nothing here"},{time:"Jun '15 - Today",place:"Co & Co - 2",description:"Did a lot of things here"}]),localStorage.rememberLogin&&"false"!=localStorage.rememberLogin,i=r,t.put("token",n.getToken()),o.resolve(r)},function(e){o.reject(e.message)}),o.promise}}]).factory("uploadAvatarService",["$http","$cookies",function(e,t){return function(n){return new Promise(function(r,i){var o=new FormData;o.append("file",n),o.append("token",t.get("token")),e({method:"POST",url:"/profile/edit/avatar",headers:{"Content-Type":void 0},data:o}).success(function(e){r(e)}).error(function(e,t){i(e)})})}}]).factory("uploadWallpaperService",["$http","$cookies",function(e,t){return function(n){return new Promise(function(r,i){var o=new FormData;o.append("file",n),o.append("token",t.get("token")),e({method:"POST",url:"/profile/edit/wallpaper",headers:{"Content-Type":void 0},data:o}).success(function(e){r(e)}).error(function(e,t){i(e)})})}}]).factory("certificatesService",["$http","$cookies",function(e,t){return{add:function(n){return new Promise(function(r,i){var o=new FormData;o.append("file",n),o.append("token",t.get("token")),e({method:"POST",url:"/profile/edit/addcertificate",headers:{"Content-Type":void 0},data:o}).success(function(e){r(e)}).error(function(e,t){i(e)})})},remove:function(n){return new Promise(function(r,i){e({method:"POST",url:"/profile/edit/removecertificate",data:{filename:n.filename,token:t.get("token")}}).success(r).error(function(e,t){i(e)})})}}}]).factory("downloadsService",["$http","$cookies",function(e,t){return{add:function(n){return new Promise(function(r,i){var o=new FormData;o.append("file",n),o.append("token",t.get("token")),e({method:"POST",url:"/profile/edit/adddownload",headers:{"Content-Type":void 0},data:o}).success(function(e){r(e)}).error(function(e,t){i(e)})})},remove:function(n){return new Promise(function(r,i){e({method:"POST",url:"/profile/edit/removedownload",data:{filename:n.filename,token:t.get("token")}}).success(r).error(function(e,t){i(e)})})}}}]).factory("feedService",["$sce","$http","$cookies",function(e,t,n){return{all:function(){return t({method:"GET",url:"/article/all",cache:!1,headers:{Authorization:n.get("token")||"guest"}}).then(function(e){var t=e.data;for(var n in t){var r=t[n];if(r.ratings.expert.likes=numeral(r.ratings.expert.likes).format("0a").toUpperCase(),r.ratings.expert.dislikes=numeral(r.ratings.expert.dislikes).format("0a").toUpperCase(),r.ratings.expert.shares=numeral(r.ratings.expert.shares).format("0a").toUpperCase(),r.ratings.journalist.likes=numeral(r.ratings.journalist.likes).format("0a").toUpperCase(),r.ratings.journalist.dislikes=numeral(r.ratings.journalist.dislikes).format("0a").toUpperCase(),r.ratings.journalist.shares=numeral(r.ratings.journalist.shares).format("0a").toUpperCase(),r.ratings.visitor.likes=numeral(r.ratings.visitor.likes).format("0a").toUpperCase(),r.ratings.visitor.dislikes=numeral(r.ratings.visitor.dislikes).format("0a").toUpperCase(),r.ratings.visitor.shares=numeral(r.ratings.visitor.shares).format("0a").toUpperCase(),r.comments)for(var i in r.comments){var o=r.comments[i];r.comments[i]=o}t[n]=r}return t},function(e,t){return e})},my:function(){return t({method:"GET",url:"/article/my",cache:!1,headers:{Authorization:n.get("token")}}).then(function(e){var t=e.data;for(var n in t){var r=t[n];if(r.ratings.expert.likes=numeral(r.ratings.expert.likes).format("0a").toUpperCase(),r.ratings.expert.dislikes=numeral(r.ratings.expert.dislikes).format("0a").toUpperCase(),r.ratings.expert.shares=numeral(r.ratings.expert.shares).format("0a").toUpperCase(),r.ratings.journalist.likes=numeral(r.ratings.journalist.likes).format("0a").toUpperCase(),r.ratings.journalist.dislikes=numeral(r.ratings.journalist.dislikes).format("0a").toUpperCase(),r.ratings.journalist.shares=numeral(r.ratings.journalist.shares).format("0a").toUpperCase(),r.ratings.visitor.likes=numeral(r.ratings.visitor.likes).format("0a").toUpperCase(),r.ratings.visitor.dislikes=numeral(r.ratings.visitor.dislikes).format("0a").toUpperCase(),r.ratings.visitor.shares=numeral(r.ratings.visitor.shares).format("0a").toUpperCase(),r.comments)for(var i in r.comments){var o=r.comments[i];r.comments[i]=o}t[n]=r}return t},function(e,t){return e})}}}]).factory("postService",["$http","$cookies",function(e,t){return{create:function(n,r){return new Promise(function(i,o){var a=new FormData;if(a.append("text",n),r.length>0)for(var s in r)a.append("files",r[s]);e({method:"POST",url:"/article/create",headers:{Authorization:t.get("token"),"Content-Type":void 0},uploadEventHandlers:{progress:function(e){console.log(e.loaded,e.total)}},data:a}).success(function(e){i(e)}).error(function(e,t){o(e)})})},getComments:function(n){return e({method:"GET",url:"/article/comment/get",cache:!1,headers:{Authorization:t.get("token")},params:{postId:n}}).then(function(e){return e.data},function(e,t){return e})}}}]).factory("commentService",["$http","$cookies",function(e,t){return{add:function(n,r,i){var o=new FormData;if(o.append("postId",n),o.append("text",r),i.length>0)for(var a in i)o.append("files",i[a]);return e({method:"POST",url:"/article/comment/add",headers:{Authorization:t.get("token"),"Content-Type":void 0},data:o}).then(function(e){return e},function(e,t){return e})}}}]).factory("familiarExpertsService",function(){return new Promise(function(e,t){var n=[{id:1,name:"Keanu Reeves",role:"Expert",image:"https://s.aolcdn.com/hss/storage/midas/627f1d890718ff2c58318a280145a153/203216448/nicholas-cage-con-air.jpg",color:"bronze",rating:2,likes_percentage:70},{id:2,name:"Keanu Reeves",role:"Expert",image:"https://s.aolcdn.com/hss/storage/midas/627f1d890718ff2c58318a280145a153/203216448/nicholas-cage-con-air.jpg",color:"bronze",rating:2,likes_percentage:70},{id:3,name:"Keanu Reeves",role:"Expert",image:"https://s.aolcdn.com/hss/storage/midas/627f1d890718ff2c58318a280145a153/203216448/nicholas-cage-con-air.jpg",color:"bronze",rating:2,likes_percentage:70}];e(n)})}).factory("categoriesService",["$http","$q",function(e,t){return function(e){var n=t.defer(),r=[{id:1,title:"World News",count:353478392},{id:2,title:"Canada News",count:12478392},{id:3,title:"Buzz News",count:4478392},{id:4,title:"Science",count:2478392},{id:5,title:"Business",count:532952},{id:6,title:"Health",count:422321},{id:7,title:"Technology",count:352210},{id:8,title:"Sport",count:24990},{id:9,title:"Entertainment",count:1224}];return n.resolve(r),n.promise}}]).factory("groupedCountriesService",["$http","$q",function(e,t){return function(e){var n=t.defer(),r=[{id:1,title:"North America",sub:[{id:2,title:"United States"},{id:3,title:"Canada"},{id:4,title:"Mexico"}]},{id:5,title:"Central & South America",sub:[{id:6,title:"Brazil"},{id:7,title:"Chile"},{id:8,title:"Argentina"}]}];return n.resolve(r),n.promise}}]),angular.module("er.validators",[]).directive("email");